<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Mini App</title>

  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    body {
      font-family: sans-serif;
      padding: 16px;
    }
    .page {
      display: none;
    }
    .page.active {
      display: block;
    }
  </style>
</head>
<body>
  <div id="app">
  </div>

<script>
  const pages = {
  home: `
    <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å üëã</h1>
    <p>–¢—ã –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ!</p>
    <p>Telegram ID:</p>
    <p id="userTgId"></p>
    <p>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</p>
    <p id="userName"></p>
  `,

  "page1": `
    <h1>–¢—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ 1</h1>
  `,

  "page2": `
    <h1>–¢—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ 2</h1>
  `
};

const tg = window.Telegram.WebApp;
const tgData = window.Telegram.WebApp.initData
const user = tg.initDataUnsafe.user; // –û–±—ä–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
console.log("–î–∞–Ω–Ω—ã–µ:", tgData);
console.log("–Æ–∑–µ—Ä:", user)
console.log("–¢–ì:", tg)

const hash = window.location.hash.slice(1);
console.log("hash is", hash);
console.log("window tg", window.Telegram)
console.log("window location", window.location)

// Use URLSearchParams to easily parse the parameters
const parametres = new URLSearchParams(hash);

// Get the value of the 'tgWebAppStartParam'
const startParam = parametres.get('tgWebAppStartParam'); 

console.log(`param is: ${startParam}`);

const app = document.getElementById("app");

// —Ä–µ–Ω–¥–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
function render(pageId) {
  app.innerHTML = pages[pageId] || pages.home;
}

// –æ—Ç–∫—Ä—ã—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
function openPage(pageId) {
  history.pushState({ pageId }, "", `?pageId=${pageId}`);
  render(pageId);
}

// –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é
function goHome() {
  history.pushState({}, "", "/");
  render("home");
}

// –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
const params = new URLSearchParams(window.location.search);
const pageId = params.get("pageId") || "home";
render(pageId);

// –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–æ–∫ ¬´–Ω–∞–∑–∞–¥¬ª –≤ –±—Ä–∞—É–∑–µ—Ä–µ
window.onpopstate = (e) => {
  const page = e.state?.pageId || "home";
  render(page);
};




let userName = document.getElementById("userName");
userName.textContent = user.first_name;
let userTgId = document.getElementById("userTgId");
userTgId.textContent = user.id;

if (user) {
    console.log("ID:", user.id);
    console.log("–ò–º—è:", user.first_name);
    console.log("Username:", user.username);
    console.log("–Ø–∑—ã–∫:", user.language_code);
}

</script>
</body>
</html>
